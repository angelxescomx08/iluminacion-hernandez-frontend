---
import { Picture } from "astro:assets";
// Import de prueba solicitado
import imgWarm from "../assets/images/light-experience/calida.webp";

const images = [imgWarm, imgWarm, imgWarm, imgWarm];
// Duplicamos para el loop infinito
const doubleImages = [...images, ...images];
---

<section class="py-12 bg-white overflow-hidden">
  <div class="max-w-7xl mx-auto px-4 sm:px-6">
    <div class="text-center mb-16">
      <h2
        class="text-[10px] uppercase tracking-[0.5em] text-amber-600 font-bold mb-4"
      >
        Catálogo Visual
      </h2>
      <h3
        class="text-3xl md:text-5xl font-montserrat font-light text-neutral-900"
      >
        Flujo de <span class="italic font-serif">inspiración</span>.
      </h3>
    </div>

    <div class="relative h-[600px] md:h-[800px] overflow-hidden">
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4 h-full">
        <div class="scroll-column up" style="--duration: 18s;">
          <div class="scroll-content">
            {
              doubleImages.map((img) => (
                <div class="item aspect-3/4">
                  <Picture
                    src={img}
                    alt="Luz"
                    formats={["avif", "webp"]}
                    widths={[400]}
                    class="w-full h-full object-cover rounded-3xl"
                    inferSize={true}
                    loading="lazy"
                  />
                </div>
              ))
            }
          </div>
        </div>

        <div class="scroll-column down" style="--duration: 35s;">
          <div class="scroll-content">
            {
              doubleImages.map((img) => (
                <div class="item aspect-square">
                  <Picture
                    src={img}
                    alt="Luz"
                    formats={["avif", "webp"]}
                    widths={[400]}
                    class="w-full h-full object-cover rounded-3xl"
                    inferSize={true}
                    loading="lazy"
                  />
                </div>
              ))
            }
          </div>
        </div>

        <div class="scroll-column up hidden md:flex" style="--duration: 25s;">
          <div class="scroll-content">
            {
              doubleImages.map((img) => (
                <div class="item aspect-4/5">
                  <Picture
                    src={img}
                    alt="Luz"
                    formats={["avif", "webp"]}
                    widths={[400]}
                    class="w-full h-full object-cover rounded-3xl"
                    inferSize={true}
                    loading="lazy"
                  />
                </div>
              ))
            }
          </div>
        </div>

        <div class="scroll-column down hidden md:flex" style="--duration: 45s;">
          <div class="scroll-content">
            {
              doubleImages.map((img) => (
                <div class="item aspect-2/3">
                  <Picture
                    src={img}
                    alt="Luz"
                    formats={["avif", "webp"]}
                    widths={[400]}
                    class="w-full h-full object-cover rounded-3xl"
                    inferSize={true}
                    loading="lazy"
                  />
                </div>
              ))
            }
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  .scroll-column {
    position: relative;
    height: 100%;
    will-change: transform;
  }

  .scroll-content {
    display: flex;
    flex-direction: column;
    gap: 1rem; /* gap-4 de Tailwind */
  }

  .item {
    width: 100%;
    flex-shrink: 0;
  }

  /* --- ANIMACIONES CON TIEMPOS DIFERENTES --- */

  /* Subida: De 0 a la mitad exacta menos medio gap */
  @keyframes scrollUp {
    0% {
      transform: translateY(0);
    }
    100% {
      transform: translateY(calc(-50% - 0.5rem));
    }
  }

  /* Bajada: De la mitad a 0 */
  @keyframes scrollDown {
    0% {
      transform: translateY(calc(-50% - 0.5rem));
    }
    100% {
      transform: translateY(0);
    }
  }

  .up .scroll-content {
    animation: scrollUp var(--duration) linear infinite;
  }

  .down .scroll-content {
    animation: scrollDown var(--duration) linear infinite;
  }

  /* Forzamos que nunca se detenga */
  .scroll-column:hover .scroll-content {
    animation-play-state: running;
  }
</style>
